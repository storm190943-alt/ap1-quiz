<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IHK AP1 Profi-Trainer</title>
    <style>
        :root { --primary: #2563eb; --success: #16a34a; --error: #dc2626; --bg: #f1f5f9; --text: #0f172a; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: var(--text); padding: 10px; display: flex; justify-content: center; margin: 0; }
        .container { width: 100%; max-width: 750px; padding-top: 20px; }
        .card { background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-top: 10px; }
        .hidden { display: none !important; }
        .btn { padding: 14px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 10px; font-size: 1rem; transition: 0.2s; }
        .primary-btn { background: var(--primary); color: white; }
        .option-item { display: flex; align-items: center; padding: 16px; border: 2px solid #e2e8f0; border-radius: 10px; margin-bottom: 10px; cursor: pointer; background: #fff; transition: 0.2s; }
        .option-item:hover { border-color: var(--primary); }
        .option-item.selected { border-color: var(--primary); background: #eff6ff; }
        .correct-ui { border-color: var(--success) !important; background: #f0fdf4 !important; border-width: 3px; }
        .wrong-ui { border-color: var(--error) !important; background: #fef2f2 !important; }
        input[type="text"] { width: 100%; padding: 15px; border: 2px solid #ccc; border-radius: 8px; font-size: 1.1rem; box-sizing: border-box; }
        .progress-bar { background: #e2e8f0; height: 10px; border-radius: 5px; margin-bottom: 20px; overflow: hidden; }
        #progress-fill { background: var(--primary); height: 100%; width: 0%; transition: 0.4s; }
        #explanation-box { background: #f8fafc; padding: 15px; border-left: 5px solid var(--primary); margin-top: 15px; font-size: 0.95rem; line-height: 1.5; }
    </style>
</head>
<body>
    <div class="container">
        <div id="setup-screen" class="card">
            <h1>IHK AP1 Trainer Plus</h1>
            <p>Inklusive Rechenaufgaben & LÃ¼ckentexten.</p>
            <select id="topic-select" class="btn" style="background: white; border: 2px solid #e2e8f0; text-align: left;"></select>
            <button onclick="startQuiz('learn')" class="btn primary-btn">Lernmodus</button>
            <button onclick="startQuiz('exam')" class="btn" style="background: #64748b; color: white;">PrÃ¼fungsmodus</button>
        </div>

        <div id="quiz-screen" class="card hidden">
            <div class="progress-bar"><div id="progress-fill"></div></div>
            <div id="meta" style="font-size: 0.8rem; color: #64748b; font-weight: bold; margin-bottom: 5px;"></div>
            <h2 id="question-text" style="margin-top:0"></h2>
            <div id="options-container"></div>
            <div id="feedback-area" class="hidden">
                <p id="feedback-text" style="font-weight: bold; font-size: 1.1rem; border-top: 1px solid #eee; padding-top: 15px;"></p>
                <div id="explanation-box"></div>
            </div>
            <button id="check-btn" onclick="checkAnswer()" class="btn primary-btn">PrÃ¼fen</button>
            <button id="next-btn" onclick="nextQuestion()" class="btn primary-btn hidden">NÃ¤chste Frage</button>
        </div>

        <div id="result-screen" class="card hidden">
            <h2>Dein Ergebnis</h2>
            <p id="score-display" style="font-size: 1.3rem;"></p>
            <button onclick="location.reload()" class="btn primary-btn">Neu starten</button>
        </div>
    </div>

    <script>
        const allQuestions = [
            // --- HARDWARE / NETZWERK ---
            {
                chapter: "Hardware", type: "input",
                question: "Wie viele nutzbare Host-IP-Adressen hat ein /28 Subnetz?",
                correctAnswers: ["14"],
                explanation: "Ein /28 Netz hat 2^(32-28) = 16 Adressen. AbzÃ¼glich Netz-ID und Broadcast bleiben 14 nutzbare Adressen."
            },
            {
                chapter: "Hardware", type: "input",
                question: "Rechnen Sie die Hex-Zahl 'A' in eine Dezimalzahl um.",
                correctAnswers: ["10"],
                explanation: "Im Hexadezimalsystem steht A fÃ¼r 10, B fÃ¼r 11, C fÃ¼r 12 usw."
            },
            {
                chapter: "Netzwerk", type: "multi",
                question: "Welche Protokolle werden zur E-Mail-Ãœbertragung oder zum Abruf genutzt?",
                options: ["SMTP", "POP3", "IMAP", "SNMP", "FTP"],
                correctAnswers: [0, 1, 2],
                explanation: "SMTP sendet, POP3 und IMAP empfangen Mails. SNMP ist fÃ¼r Netzwerkmanagement, FTP fÃ¼r Dateitransfer."
            },
            // --- WIRTSCHAFT / RECHT ---
            {
                chapter: "Wirtschaft", type: "single",
                question: "Wie nennt man die Versicherung, die bei ArbeitsunfÃ¤llen eintritt?",
                options: ["Rentenversicherung", "Berufsgenossenschaft", "Pflegeversicherung", "Arbeitslosenversicherung"],
                correctAnswers: [1],
                explanation: "Die Berufsgenossenschaften sind die TrÃ¤ger der gesetzlichen Unfallversicherung."
            },
            {
                chapter: "Wirtschaft", type: "input",
                question: "Wie hoch ist der Arbeitnehmeranteil (in %) am Beitrag zur Krankenversicherung ohne Zusatzbeitrag? (Zahl mit Komma, z.B. 7,3)",
                correctAnswers: ["7,3"],
                explanation: "Der allgemeine Beitragssatz betrÃ¤gt 14,6%. Davon tragen AG und AN jeweils die HÃ¤lfte (7,3%)."
            },
            {
                chapter: "Recht", type: "multi",
                question: "Welche Angaben mÃ¼ssen zwingend in einem Ausbildungsvertrag stehen?",
                options: ["Dauer der Probezeit", "HÃ¶he der VergÃ¼tung", "Name der Eltern (bei VolljÃ¤hrigen)", "Beginn und Dauer der Ausbildung"],
                correctAnswers: [0, 1, 3],
                explanation: "Probezeit, VergÃ¼tung und Dauer sind Pflicht. Der Name der Eltern ist nur bei MinderjÃ¤hrigen Pflicht."
            },
            // --- PROJEKTMANAGEMENT ---
            {
                chapter: "Projekt", type: "input",
                question: "Was ist der Gesamtpuffer (GP) eines Vorgangs auf dem kritischen Pfad?",
                correctAnswers: ["0"],
                explanation: "Der kritische Pfad zeichnet sich dadurch aus, dass alle VorgÃ¤nge einen Puffer von Null haben."
            },
            {
                chapter: "Programmierung", type: "input",
                question: "Welches SQL-SchlÃ¼sselwort wird verwendet, um Duplikate im Ergebnis zu vermeiden?",
                correctAnswers: ["DISTINCT"],
                explanation: "SELECT DISTINCT filtert doppelte DatensÃ¤tze aus der Ergebnismenge."
            },
            {
                chapter: "Hardware", type: "single",
                question: "Welcher RAID-Level bietet die hÃ¶chste KapazitÃ¤t bei gleichzeitigem Schutz durch ParitÃ¤t bei 4 Platten?",
                options: ["RAID 1", "RAID 5", "RAID 6", "RAID 10"],
                correctAnswers: [1],
                explanation: "RAID 5 verliert nur die KapazitÃ¤t einer Platte fÃ¼r ParitÃ¤t (n-1). RAID 6 verliert zwei (n-2) und RAID 10 die HÃ¤lfte (n/2)."
            }
        ];

        let quizData = [];
        let currentIndex = 0;
        let score = 0;
        let mode = 'learn';

        window.onload = function() {
            const select = document.getElementById('topic-select');
            const chapters = ["Alle Themen", ...new Set(allQuestions.map(q => q.chapter))].sort();
            chapters.forEach(c => {
                const opt = document.createElement('option');
                opt.value = c === "Alle Themen" ? "all" : c;
                opt.innerText = c;
                select.appendChild(opt);
            });
        };

        window.startQuiz = function(m) {
            mode = m;
            const filter = document.getElementById('topic-select').value;
            quizData = filter === 'all' ? [...allQuestions] : allQuestions.filter(q => q.chapter === filter);
            quizData.sort(() => Math.random() - 0.5);
            document.getElementById('setup-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            showQuestion();
        };

        function showQuestion() {
            const q = quizData[currentIndex];
            document.getElementById('progress-fill').style.width = `${(currentIndex / quizData.length) * 100}%`;
            document.getElementById('meta').innerText = `${q.chapter.toUpperCase()} | FRAGE ${currentIndex + 1} / ${quizData.length}`;
            document.getElementById('question-text').innerText = q.question;
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            
            if(q.type === 'input') {
                const input = document.createElement('input');
                input.type = 'text';
                input.id = 'user-answer';
                input.placeholder = 'Antwort eingeben...';
                container.appendChild(input);
                input.focus();
            } else {
                q.options.forEach((opt, idx) => {
                    const div = document.createElement('div');
                    div.className = 'option-item';
                    div.innerHTML = `<input type="${q.type === 'multi' ? 'checkbox' : 'radio'}" name="ans" id="opt${idx}"> <label style="margin-left:10px">${opt}</label>`;
                    div.onclick = function() {
                        const inp = this.querySelector('input');
                        if(q.type === 'single') {
                            container.querySelectorAll('.option-item').forEach(i => { i.classList.remove('selected'); i.querySelector('input').checked = false; });
                            inp.checked = true;
                        } else { inp.checked = !inp.checked; }
                        this.classList.toggle('selected', inp.checked);
                    };
                    container.appendChild(div);
                });
            }
            document.getElementById('feedback-area').classList.add('hidden');
            document.getElementById('check-btn').classList.remove('hidden');
            document.getElementById('next-btn').classList.add('hidden');
        }

        window.checkAnswer = function() {
            const q = quizData[currentIndex];
            let isCorrect = false;
            
            if(q.type === 'input') {
                const val = document.getElementById('user-answer').value.trim().toLowerCase();
                isCorrect = q.correctAnswers.some(a => a.toLowerCase() === val);
            } else {
                const selected = Array.from(document.querySelectorAll('input[name="ans"]:checked')).map(i => parseInt(i.id.replace('opt','')));
                if(selected.length === 0) return alert("WÃ¤hle eine Antwort!");
                isCorrect = JSON.stringify(selected.sort()) === JSON.stringify(q.correctAnswers.sort());
            }

            if(isCorrect) score++;

            if(mode === 'learn') {
                if(q.type !== 'input') {
                    const items = document.querySelectorAll('.option-item');
                    q.correctAnswers.forEach(idx => items[idx].classList.add('correct-ui'));
                }
                document.getElementById('feedback-area').classList.remove('hidden');
                document.getElementById('feedback-text').innerHTML = isCorrect ? "<span style='color:var(--success)'>âœ” RICHTIG</span>" : `<span style='color:var(--error)'>âœ– FALSCH (LÃ¶sung: ${q.correctAnswers.join(', ')})</span>`;
                document.getElementById('explanation-box').innerText = q.explanation;
                document.getElementById('check-btn').classList.add('hidden');
                document.getElementById('next-btn').classList.remove('hidden');
            } else { nextQuestion(); }
        };

        window.nextQuestion = function() {
            currentIndex++;
            if(currentIndex < quizData.length) showQuestion();
            else showResult();
        };

        function showResult() {
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            const p = Math.round((score/quizData.length)*100);
            document.getElementById('score-display').innerHTML = `Ergebnis: <b>${score}/${quizData.length}</b> (${p}%).<br>${p >= 50 ? 'Bestanden! ðŸŽ‰' : 'Nicht bestanden. ðŸ“š'}`;
        }
    </script>
</body>
</html>
